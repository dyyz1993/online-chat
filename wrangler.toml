name = "online-chat"
main = "src/server/index.worker.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = "./dist"
binding = "ASSETS"

# Environment variables
[vars]
BARK_API = "https://api.day.app"
STAFF_URL_BASE = "https://online-chat.dyyz1993.workers.dev/staff"
# Auth: Cloudflare Workers deployment does not require password (public demo)
REQUIRE_AUTH = "false"
# Auth: Cloudflare Workers deployment does not require password (public demo)
REQUIRE_AUTH = "false"

[[d1_databases]]
binding = "DB"
database_name = "online-chat-db"
database_id = "22d3de4b-18a7-4571-b6b7-3393fdf50a91"

# R2 bucket for file uploads
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "online-chat-uploads"

[build]
command = "npm run build:worker"

[env.production]
name = "online-chat-prod"

[env.production.vars]
BARK_API = "https://api.day.app"
STAFF_URL_BASE = "https://online-chat.dyyz1993.workers.dev/staff"

[env.production.d1_databases]
binding = "DB"
database_name = "online-chat-db"
database_id = "22d3de4b-18a7-4571-b6b7-3393fdf50a91"

[env.production.r2_buckets]
binding = "BUCKET"
bucket_name = "online-chat-uploads"
